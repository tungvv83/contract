{% extends 'partials/base.html' %} {% load static %} {% block title %}Nhóm{% endblock title %} {% block content %}
<div class="main-content">
    <div class="page-content">
        <!-- start page title -->
        <div class="page-title-box">
            <div class="container-fluid">
                <div class="row align-items-center">
                    <div class="col-sm-6">
                    </div>
                    <div class="col-sm-6">
                        <div class="float-end d-none d-sm-block">
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <!-- end page title -->
        <div class="container-fluid">
            <div class="page-content-wrapper">
                <div class="row">
                    <div class="col-lg-12">
                        <div class="card">
                            <div class="card-body">
                                <h4 class="header-title">Thêm Nhóm</h4>
                                <p class="card-title-desc"></p>

                                {% csrf_token %}
                                <div class="row">
                                    <div class="col-md-12">
                                        <div class="mb-3">
                                            <label for="name" class="form-label">Tên nhóm</label>
                                            <input type="text" class="form-control" id="name" placeholder="Tên nhóm" required>
                                        </div>
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-md-4">
                                        <button type="Submit" id="submit" class="btn btn-primary waves-effect waves-light me-1">
                                                Submit
                                            </button>
                                        <button type="reset" onclick="resetInput()" id="cancel" class="btn btn-secondary waves-effect">
                                                Cancel
                                            </button>
                                    </div>
                                </div>

                                <span id="iduser" style="display: none;"> {{user.id}}</span>

                            </div>
                        </div>
                    </div>
                </div>
                <!-- end row -->
            </div>
            <!-- container-fluid -->
        </div>
        <script>
            const btn_submit = document.getElementById('submit')
            const domain = window.location.origin

            btn_submit.addEventListener('click', () => {
                const name_input = document.getElementById('name').value
                const id = document.getElementById('iduser').textContent
                if (name_input == '') {
                    return
                } else {
                    $.ajax({
                        url: `${domain}/contract/createGroup`,
                        method: 'POST',
                        data: {
                            userid: id,
                            nameGroup: name_input
                        },
                        success: (data) => {
                            window.location.replace(`${window.location.origin}/contract/detail/group?id=${data['id']}`)
                        },
                        error: (err) => {
                            console.log(err);
                        }
                    })
                }
            })

            function resetInput() {
                window.location.reload()
            }
        </script>
        <!-- End Page-content -->
        {% endblock content %} {% block extra_javascript %}
        <script src="{% static 'libs/parsleyjs/dist/parsley.min.js' %}"></script>
        <script src="{% static 'libs/bootstrap-datepicker/dist/js/bootstrap-datepicker.min.js' %}"></script>

        <!-- form mask -->
        <script src="{% static 'libs/inputmask/dist/jquery.inputmask.min.js' %}"></script>
        <!-- form mask init -->
        <script src="{% static 'js/pages/form-mask.init.js' %}"></script>

        <script src="{% static 'js/pages/form-validation.init.js' %}"></script>

        {% endblock extra_javascript %}